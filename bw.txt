### THP 옵션 비활성화

1. 아래와 같이 명령어를 입력하여 현재 active 상태인 tuned profile을 확인함
   [centos@ip-172-31-9-87 ~]$ tuned-adm active
   Current active profile: virtual-guest

2. virtual-gues로 나오면 현재 OS가 가상머신을 통해 운영중임
   throughput-performance로 나오면 실제 서버에서 운영중인 상황임으로 표시함

3. 새로 생성하길 원하는 프로필 명으로 /etc/tuned 아래 경로에 디렉토리를 생성합니다.
 (여기서는 프로필명이 cubrid라고 가정)

 [centos@ip-172-31-9-87 ~]$ sudo mkdir /etc/tuned/cubrid

4. 새로 생성한 디렉토리 안에 tuned.conf 파일을 다음과 같이 생성 후 저장합니다
  [centos@ip-172-31-9-87 ~]$ sudo vi /etc/tuned/cubrid/tuned.conf

[main]
include= throughput-performance
[vm]
transparent_hugepages=never

5. 위에 생성한 파일에 실행 권한을 부여합니다.

  [centos@ip-172-31-9-87 ~]$ sudo chmod +x /etc/tuned/cubrid/tuned.conf

6. 새로 만든 프로필을 활성화합니다.
  [centos@ip-172-31-9-87 ~]$ sudo tuned-adm profile cubrid
7. /etc/sysconfig/grub 파일에 다음과 같이 transparent_hugepage=never 커널 파라미터를 추가합니다.
GRUB_TIMEOUT=1
GRUB_DISTRIBUTOR="$(sed 's, release .*$,,g' /etc/system-release)"
GRUB_DEFAULT=saved
GRUB_DISABLE_SUBMENU=true
GRUB_TERMINAL="serial console"
GRUB_SERIAL_COMMAND="serial --speed=115200"
GRUB_CMDLINE_LINUX="console=tty0 crashkernel=auto console=ttyS0,115200 transparent_hugepage=never"
GRUB_DISABLE_RECOVERY="true"


/* GRUB_CMDLINE_LINUX 의 맨 뒤에 transparent_hugepage=never 추가 */

8. grub2-mkconfig를 통해 grub.cfg 파일을 재생성합니다.

[centos@ip-172-31-9-87 ~]$ sudo grub2-mkconfig -o /boot/grub2/grub.cfg

9. 재부팅 후 아래 명령어를 통해 설정 내용을 확인합니다.
출력 결과에 위에서 추가한 사항이 포함되어 있으면 성공입니다.

[centos@ip-172-31-9-87 ~]$ sudo reboot -f
[centos@ip-172-31-9-87 ~]$ cat /proc/cmdline
BOOT_IMAGE=/vmlinuz-3.10.0-229.20.1.el7.x86_64 root=/dev/mapper/centos-root ro rd.lvm.lv=centos/root rd.lvm.lv=centos/swap crashkernel=auto rhgb quiet transparent_hugepage=never
